
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tutorial 1 - Weather Data: Accesing it, understanding it, visualizing it! &#8212; PyData 2021: Solar PV Modeling</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Tutorial 2 - POA Irradiance" href="Tutorial%202%20-%20POA%20Irradiance.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/tutorial_banner.PNG" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">PyData 2021: Solar PV Modeling</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1 current">
  <a class="reference internal" href="#">
   Tutorial 1 - Weather Data: Accesing it, understanding it, visualizing it!
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Tutorial%202%20-%20POA%20Irradiance.html">
   Tutorial 2 - POA Irradiance
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Tutorial%203%20-%20Array%20Power.html">
   Tutorial 3 - Modeling an Array Power
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Tutorial%20A%20-%20Single%20Diode%20Model.html">
   Tutorial A - Single Diode Model
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Tutorial%20B%20-%20pvfree.html">
   Tutorial B - pvfree
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Tutorial%20C%20-%20Modeling%20Module%27s%20Performance%20Advanced.html">
   Tutorial C - PV Module Performance Advanced
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Tutorial%20D%20-%20pySAM%20Modeling%20the%20Bifacial%20Tracker%20Field%20at%20NREL.html">
   6 - pySAM Simulation
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Tutorial 1 - TMY Weather Data.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/PVSC-Python-Tutorials/pyData-2021-Solar-PV-Modeling"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/PVSC-Python-Tutorials/pyData-2021-Solar-PV-Modeling/issues/new?title=Issue%20on%20page%20%2FTutorial 1 - TMY Weather Data.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/PVSC-Python-Tutorials/pyData-2021-Solar-PV-Modeling/main?urlpath=tree/Tutorial 1 - TMY Weather Data.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        <a class="jupyterhub-button" href="https://pvsc-python-tutorial.ml/hub/user-redirect/git-pull?repo=https://github.com/PVSC-Python-Tutorials/pyData-2021-Solar-PV-Modeling&urlpath=tree/pyData-2021-Solar-PV-Modeling/Tutorial 1 - TMY Weather Data.ipynb&branch=main"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch JupyterHub" data-toggle="tooltip"
                data-placement="left"><img class="jupyterhub-button-logo"
                    src="_static/images/logo_jupyterhub.svg"
                    alt="Interact on JupyterHub">JupyterHub</button></a>
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#steps">
   Steps:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pv-concepts">
   PV Concepts:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#python-concepts">
   Python Concepts:
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#weather-data-pv">
   Weather Data &amp; PV
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#typical-meteorological-year">
   Typical Meteorological Year
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#first-step-import-libraries">
   First Step: Import Libraries
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reading-a-tmy-dataset-with-pvlib">
   Reading a TMY dataset with pvlib
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#irradiance">
   Irradiance
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#wind">
   Wind
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#air-temperature">
   Air temperature
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#downselect-columns">
   Downselect columns
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-time-series-data-with-pandas-and-matplotlib">
   Plotting time series data with pandas and matplotlib
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Irradiance
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#exercise">
       Exercise
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#temperature">
     Temperature
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wind-speed">
     Wind speed
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#aggregating-hourly-data-to-monthly-summaries">
   Aggregating hourly data to monthly summaries
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     Exercise
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#where-to-get-free-solar-irradiance-data">
   Where to get
   <em>
    Free
   </em>
   Solar Irradiance Data?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#where-else-can-you-get-historical-irradiance-data">
   Where else can you get historical irradiance data?
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#nrel-api-key">
   NREL API Key
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#application-programming-interface-api">
     Application Programming Interface (API)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fetching-tmys-from-the-nsrdb">
   Fetching TMYs from the NSRDB
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p><img alt="tutorialpromo" src="_images/tutorial_banner.PNG" /></p>
<div class="tex2jax_ignore mathjax_ignore section" id="tutorial-1-weather-data-accesing-it-understanding-it-visualizing-it">
<h1>Tutorial 1 - Weather Data: Accesing it, understanding it, visualizing it!<a class="headerlink" href="#tutorial-1-weather-data-accesing-it-understanding-it-visualizing-it" title="Permalink to this headline">¶</a></h1>
<p>This notebook explores a standard type of weather data, the typical meteorological year (TMY), and how to summarize it with Python and <a class="reference external" href="https://pandas.pydata.org/">Pandas</a>.</p>
<p><img alt="Overview" src="_images/tutorial_1_overview.PNG" /></p>
<div class="section" id="steps">
<h2>Steps:<a class="headerlink" href="#steps" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="#Weather-Data-&amp;-PV">Weather data in PV performance models</a></p></li>
<li><p>Looking at a sample weather data file</p></li>
<li><p>Where to get weather data from?</p></li>
<li><p>Weather data to API</p></li>
</ul>
</div>
<div class="section" id="pv-concepts">
<h2>PV Concepts:<a class="headerlink" href="#pv-concepts" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>TMY</p></li>
<li><p>GHI, DNI, DHI</p></li>
<li><p>DryBulb, Wspd</p></li>
<li><p>Irradiance vs. Insolation</p></li>
</ul>
</div>
<div class="section" id="python-concepts">
<h2>Python Concepts:<a class="headerlink" href="#python-concepts" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Exploring a Pandas dataframe (<code class="docutils literal notranslate"><span class="pre">df</span></code>): <code class="docutils literal notranslate"><span class="pre">len()</span></code>, <code class="docutils literal notranslate"><span class="pre">df.head()</span></code>, <code class="docutils literal notranslate"><span class="pre">df.keys()</span></code></p></li>
<li><p><a class="reference external" href="https://pvlib-python.readthedocs.io/en/stable/api.html#io-tools">pvlib input-output tools</a></p></li>
<li><p>Ploting a Pandas dataframe (<code class="docutils literal notranslate"><span class="pre">df</span></code>): <code class="docutils literal notranslate"><span class="pre">df.plot()</span></code></p></li>
<li><p>Aggregating data in a dataframe (<code class="docutils literal notranslate"><span class="pre">df</span></code>): <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.resample.html"><code class="docutils literal notranslate"><span class="pre">df.resample(freq).sum()</span></code></a></p></li>
<li><p>Pandas <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#dateoffset-objects"><code class="docutils literal notranslate"><span class="pre">DateOffsets</span></code></a> - shortcuts to set the frequency when resampling</p></li>
<li><p>Getting NREL irradiance data from the web based API using pvlib</p></li>
</ul>
</div>
<div class="section" id="weather-data-pv">
<h2>Weather Data &amp; PV<a class="headerlink" href="#weather-data-pv" title="Permalink to this headline">¶</a></h2>
<p>Weather and irradiance data are used as input to PV performance models.</p>
<p><img alt="SRRL" src="_images/tutorial_1_SRRL.PNG" /></p>
<p>These data are directly measured, derived from measured data, or simulated using a stochastic model.</p>
<p>If you want to learn more about irradiance data, you can visit the <a class="reference external" href="https://www.pmodwrc.ch/en/world-radiation-center-2/srs/">Solar RAdiometry webpage</a></p>
</div>
<div class="section" id="typical-meteorological-year">
<h2>Typical Meteorological Year<a class="headerlink" href="#typical-meteorological-year" title="Permalink to this headline">¶</a></h2>
<p>TMY datasets are intended to represent the weather for a typical year at a given location.</p>
<p>TMY datasets provide hourly <strong>solar irradiance</strong>, <strong>air temperature</strong>, <strong>wind speed</strong>, and other weather measurements for a hypothetical year that represents more or less a “median year” for solar resource.</p>
<p><img alt="TMY3 screenshot" src="_images/tutorial_1_tmy3_example.PNG" /></p>
<p>TMY datasets are created by selecting individual months out of an extended period of weather measurememts (say, 20 years of data) to construct a single year’s worth of data. There are several methods for selecting which months to include, but the general idea is to calculate monthly summary statistics and take the month that lies in the middle of the distribution.  For example, no two Januaries will be exactly the same, so summing the total solar irradiance for each January will give a <a class="reference external" href="https://en.wikipedia.org/wiki/Normal_distribution">normal distribution</a>, and the month that falls closest to the <a class="reference external" href="https://en.wikipedia.org/wiki/Median">median</a> is chosen as the representative month. The same process is followed for February, March, and so on, and all twelve representative months are stitched together into a year-long dataset.</p>
<p>The oldest TMYs were calculated using data from the nearest weather station (airports and such). Today, it’s common to use TMYs calculated using simulated weather data from satellite imagery because of the improved spatial resolution.</p>
<p>To get a better feel for TMY data, we’ll first explore an example TMY dataset that is bundled with pvlib.</p>
</div>
<div class="section" id="first-step-import-libraries">
<h2>First Step: Import Libraries<a class="headerlink" href="#first-step-import-libraries" title="Permalink to this headline">¶</a></h2>
<p>In Python, some functions are builtin like <code class="docutils literal notranslate"><span class="pre">print()</span></code> but others must be imported before they can be used. For this notebook we’re going to import three packages:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pvlib-python.readthedocs.io/en/stable/">pvlib</a> - library for simulating performance of photovoltaic energy systems.</p></li>
<li><p><a class="reference external" href="https://pandas.pydata.org/">pandas</a> - analysis tool for timeseries and tabular data</p></li>
<li><p><a class="reference external" href="https://matplotlib.org/">matplotlib</a> - data visualization for Python</p></li>
</ul>
<p>Some Python modules are part of the <a class="reference external" href="https://docs.python.org/3/library/index.html">standard library</a>, but are not imported with builtins. We’ll use the <code class="docutils literal notranslate"><span class="pre">pathlib</span></code> module which is useful for accessing files and folders.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>  <span class="c1"># for getting environment variables</span>
<span class="kn">import</span> <span class="nn">pathlib</span>  <span class="c1"># for finding the example dataset</span>
<span class="kn">import</span> <span class="nn">pvlib</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>  <span class="c1"># for data wrangling</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>  <span class="c1"># for visualization</span>
</pre></div>
</div>
</div>
</div>
<p>Query which version you are using of pvlib:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">pvlib</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8.1
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="reading-a-tmy-dataset-with-pvlib">
<h2>Reading a TMY dataset with pvlib<a class="headerlink" href="#reading-a-tmy-dataset-with-pvlib" title="Permalink to this headline">¶</a></h2>
<p>First, we’ll read the TMY dataset with <a class="reference external" href="https://pvlib-python.readthedocs.io/en/stable/generated/pvlib.iotools.read_tmy3.html"><code class="docutils literal notranslate"><span class="pre">pvlib.iotools.read_tmy3()</span></code></a> which returns a <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html">Pandas DataFrame</a> of the timeseries weather data and a second output with a Python dictionary of the TMY metadata like longitude, latitude, elevation, etc.</p>
<p>We will use the Python <a class="reference external" href="https://docs.python.org/3/library/pathlib.html"><code class="docutils literal notranslate"><span class="pre">pathlib</span></code></a> to get the path to the <code class="docutils literal notranslate"><span class="pre">'data'</span></code> directory which comes with the <code class="docutils literal notranslate"><span class="pre">pvlib</span></code> package. Then we can use the slash operator, <code class="docutils literal notranslate"><span class="pre">/</span></code> to make the full path to the TMY file.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">help</span><span class="p">(</span><span class="n">pvlib</span><span class="o">.</span><span class="n">iotools</span><span class="o">.</span><span class="n">read_tmy3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Help on function read_tmy3 in module pvlib.iotools.tmy:

read_tmy3(filename, coerce_year=None, recolumn=True)
    Read a TMY3 file in to a pandas dataframe.
    
    Note that values contained in the metadata dictionary are unchanged
    from the TMY3 file (i.e. units are retained). In the case of any
    discrepancies between this documentation and the TMY3 User&#39;s Manual
    [1]_, the TMY3 User&#39;s Manual takes precedence.
    
    The TMY3 files were updated in Jan. 2015. This function requires the
    use of the updated files.
    
    Parameters
    ----------
    filename : str
        A relative file path or absolute file path.
    
    coerce_year : None or int, default None
        If supplied, the year of the index will be set to `coerce_year`, except
        for the last index value which will be set to the *next* year so that
        the index increases monotonically.
    
    recolumn : bool, default True
        If ``True``, apply standard names to TMY3 columns. Typically this
        results in stripping the units from the column name.
    
    Returns
    -------
    Tuple of the form (data, metadata).
    
    data : DataFrame
        A pandas dataframe with the columns described in the table
        below. For more detailed descriptions of each component, please
        consult the TMY3 User&#39;s Manual ([1]), especially tables 1-1
        through 1-6.
    
    metadata : dict
        The site metadata available in the file.
    
    Notes
    -----
    The returned structures have the following fields.
    
    ===============   ======  ===================
    key               format  description
    ===============   ======  ===================
    altitude          Float   site elevation
    latitude          Float   site latitudeitude
    longitude         Float   site longitudeitude
    Name              String  site name
    State             String  state
    TZ                Float   UTC offset
    USAF              Int     USAF identifier
    ===============   ======  ===================
    
    =============================       ======================================================================================================================================================
    TMYData field                       description
    =============================       ======================================================================================================================================================
    TMYData.Index                       A pandas datetime index. NOTE, the index is currently timezone unaware, and times are set to local standard time (daylight savings is not included)
    TMYData.ETR                         Extraterrestrial horizontal radiation recv&#39;d during 60 minutes prior to timestamp, Wh/m^2
    TMYData.ETRN                        Extraterrestrial normal radiation recv&#39;d during 60 minutes prior to timestamp, Wh/m^2
    TMYData.GHI                         Direct and diffuse horizontal radiation recv&#39;d during 60 minutes prior to timestamp, Wh/m^2
    TMYData.GHISource                   See [1]_, Table 1-4
    TMYData.GHIUncertainty              Uncertainty based on random and bias error estimates                        see [2]_
    TMYData.DNI                         Amount of direct normal radiation (modeled) recv&#39;d during 60 mintues prior to timestamp, Wh/m^2
    TMYData.DNISource                   See [1]_, Table 1-4
    TMYData.DNIUncertainty              Uncertainty based on random and bias error estimates                        see [2]_
    TMYData.DHI                         Amount of diffuse horizontal radiation recv&#39;d during 60 minutes prior to timestamp, Wh/m^2
    TMYData.DHISource                   See [1]_, Table 1-4
    TMYData.DHIUncertainty              Uncertainty based on random and bias error estimates                        see [2]_
    TMYData.GHillum                     Avg. total horizontal illuminance recv&#39;d during the 60 minutes prior to timestamp, lx
    TMYData.GHillumSource               See [1]_, Table 1-4
    TMYData.GHillumUncertainty          Uncertainty based on random and bias error estimates                        see [2]_
    TMYData.DNillum                     Avg. direct normal illuminance recv&#39;d during the 60 minutes prior to timestamp, lx
    TMYData.DNillumSource               See [1]_, Table 1-4
    TMYData.DNillumUncertainty          Uncertainty based on random and bias error estimates                        see [2]_
    TMYData.DHillum                     Avg. horizontal diffuse illuminance recv&#39;d during the 60 minutes prior to timestamp, lx
    TMYData.DHillumSource               See [1]_, Table 1-4
    TMYData.DHillumUncertainty          Uncertainty based on random and bias error estimates                        see [2]_
    TMYData.Zenithlum                   Avg. luminance at the sky&#39;s zenith during the 60 minutes prior to timestamp, cd/m^2
    TMYData.ZenithlumSource             See [1]_, Table 1-4
    TMYData.ZenithlumUncertainty        Uncertainty based on random and bias error estimates                        see [1]_ section 2.10
    TMYData.TotCld                      Amount of sky dome covered by clouds or obscuring phenonema at time stamp, tenths of sky
    TMYData.TotCldSource                See [1]_, Table 1-5, 8760x1 cell array of strings
    TMYData.TotCldUncertainty           See [1]_, Table 1-6
    TMYData.OpqCld                      Amount of sky dome covered by clouds or obscuring phenonema that prevent observing the sky at time stamp, tenths of sky
    TMYData.OpqCldSource                See [1]_, Table 1-5, 8760x1 cell array of strings
    TMYData.OpqCldUncertainty           See [1]_, Table 1-6
    TMYData.DryBulb                     Dry bulb temperature at the time indicated, deg C
    TMYData.DryBulbSource               See [1]_, Table 1-5, 8760x1 cell array of strings
    TMYData.DryBulbUncertainty          See [1]_, Table 1-6
    TMYData.DewPoint                    Dew-point temperature at the time indicated, deg C
    TMYData.DewPointSource              See [1]_, Table 1-5, 8760x1 cell array of strings
    TMYData.DewPointUncertainty         See [1]_, Table 1-6
    TMYData.RHum                        Relatitudeive humidity at the time indicated, percent
    TMYData.RHumSource                  See [1]_, Table 1-5, 8760x1 cell array of strings
    TMYData.RHumUncertainty             See [1]_, Table 1-6
    TMYData.Pressure                    Station pressure at the time indicated, 1 mbar
    TMYData.PressureSource              See [1]_, Table 1-5, 8760x1 cell array of strings
    TMYData.PressureUncertainty         See [1]_, Table 1-6
    TMYData.Wdir                        Wind direction at time indicated, degrees from north (360 = north; 0 = undefined,calm)
    TMYData.WdirSource                  See [1]_, Table 1-5, 8760x1 cell array of strings
    TMYData.WdirUncertainty             See [1]_, Table 1-6
    TMYData.Wspd                        Wind speed at the time indicated, meter/second
    TMYData.WspdSource                  See [1]_, Table 1-5, 8760x1 cell array of strings
    TMYData.WspdUncertainty             See [1]_, Table 1-6
    TMYData.Hvis                        Distance to discernable remote objects at time indicated (7777=unlimited), meter
    TMYData.HvisSource                  See [1]_, Table 1-5, 8760x1 cell array of strings
    TMYData.HvisUncertainty             See [1]_, Table 1-6
    TMYData.CeilHgt                     Height of cloud base above local terrain (7777=unlimited), meter
    TMYData.CeilHgtSource               See [1]_, Table 1-5, 8760x1 cell array of strings
    TMYData.CeilHgtUncertainty          See [1]_, Table 1-6
    TMYData.Pwat                        Total precipitable water contained in a column of unit cross section from earth to top of atmosphere, cm
    TMYData.PwatSource                  See [1]_, Table 1-5, 8760x1 cell array of strings
    TMYData.PwatUncertainty             See [1]_, Table 1-6
    TMYData.AOD                         The broadband aerosol optical depth per unit of air mass due to extinction by aerosol component of atmosphere, unitless
    TMYData.AODSource                   See [1]_, Table 1-5, 8760x1 cell array of strings
    TMYData.AODUncertainty              See [1]_, Table 1-6
    TMYData.Alb                         The ratio of reflected solar irradiance to global horizontal irradiance, unitless
    TMYData.AlbSource                   See [1]_, Table 1-5, 8760x1 cell array of strings
    TMYData.AlbUncertainty              See [1]_, Table 1-6
    TMYData.Lprecipdepth                The amount of liquid precipitation observed at indicated time for the period indicated in the liquid precipitation quantity field, millimeter
    TMYData.Lprecipquantity             The period of accumulatitudeion for the liquid precipitation depth field, hour
    TMYData.LprecipSource               See [1]_, Table 1-5, 8760x1 cell array of strings
    TMYData.LprecipUncertainty          See [1]_, Table 1-6
    TMYData.PresWth                     Present weather code, see [2]_.
    TMYData.PresWthSource               Present weather code source, see [2]_.
    TMYData.PresWthUncertainty          Present weather code uncertainty, see [2]_.
    =============================       ======================================================================================================================================================
    
    .. warning:: TMY3 irradiance data corresponds to the *previous* hour, so
        the first index is 1AM, corresponding to the irradiance from midnight
        to 1AM, and the last index is midnight of the *next* year. For example,
        if the last index in the TMY3 file was 1988-12-31 24:00:00 this becomes
        1989-01-01 00:00:00 after calling :func:`~pvlib.iotools.read_tmy3`.
    
    .. warning:: When coercing the year, the last index in the dataframe will
        become midnight of the *next* year. For example, if the last index in
        the TMY3 was 1988-12-31 24:00:00, and year is coerced to 1990 then this
        becomes 1991-01-01 00:00:00.
    
    References
    ----------
    
    .. [1] Wilcox, S and Marion, W. &quot;Users Manual for TMY3 Data Sets&quot;.
       NREL/TP-581-43156, Revised May 2008.
    
    .. [2] Wilcox, S. (2007). National Solar Radiation Database 1991 2005
       Update: Users Manual. 472 pp.; NREL Report No. TP-581-41364.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">DATA_DIR</span> <span class="o">=</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">pvlib</span><span class="o">.</span><span class="vm">__file__</span><span class="p">)</span><span class="o">.</span><span class="n">parent</span> <span class="o">/</span> <span class="s1">&#39;data&#39;</span>
<span class="n">df_tmy</span><span class="p">,</span> <span class="n">meta_dict</span> <span class="o">=</span> <span class="n">pvlib</span><span class="o">.</span><span class="n">iotools</span><span class="o">.</span><span class="n">read_tmy3</span><span class="p">(</span><span class="n">DATA_DIR</span> <span class="o">/</span> <span class="s1">&#39;723170TYA.CSV&#39;</span><span class="p">,</span> <span class="n">coerce_year</span><span class="o">=</span><span class="mi">1990</span><span class="p">)</span>
<span class="n">meta_dict</span>  <span class="c1"># display the dictionary of metadata</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;USAF&#39;: 723170,
 &#39;Name&#39;: &#39;&quot;GREENSBORO PIEDMONT TRIAD INT&quot;&#39;,
 &#39;State&#39;: &#39;NC&#39;,
 &#39;TZ&#39;: -5.0,
 &#39;latitude&#39;: 36.1,
 &#39;longitude&#39;: -79.95,
 &#39;altitude&#39;: 273.0}
</pre></div>
</div>
</div>
</div>
<p>Let’s display the first 4 lines of the dataframe</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tmy</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Date (MM/DD/YYYY)</th>
      <th>Time (HH:MM)</th>
      <th>ETR</th>
      <th>ETRN</th>
      <th>GHI</th>
      <th>GHISource</th>
      <th>GHIUncertainty</th>
      <th>DNI</th>
      <th>DNISource</th>
      <th>DNIUncertainty</th>
      <th>...</th>
      <th>Alb</th>
      <th>AlbSource</th>
      <th>AlbUncertainty</th>
      <th>Lprecipdepth</th>
      <th>Lprecipquantity</th>
      <th>LprecipSource</th>
      <th>LprecipUncertainty</th>
      <th>PresWth</th>
      <th>PresWthSource</th>
      <th>PresWthUncertainty</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1990-01-01 01:00:00-05:00</th>
      <td>01/01/1988</td>
      <td>01:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>?</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>D</td>
      <td>9</td>
      <td>0</td>
      <td>C</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1990-01-01 02:00:00-05:00</th>
      <td>01/01/1988</td>
      <td>02:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>?</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>D</td>
      <td>9</td>
      <td>0</td>
      <td>C</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1990-01-01 03:00:00-05:00</th>
      <td>01/01/1988</td>
      <td>03:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>?</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>D</td>
      <td>9</td>
      <td>0</td>
      <td>C</td>
      <td>8</td>
    </tr>
    <tr>
      <th>1990-01-01 04:00:00-05:00</th>
      <td>01/01/1988</td>
      <td>04:00</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>...</td>
      <td>0.0</td>
      <td>?</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>D</td>
      <td>9</td>
      <td>0</td>
      <td>C</td>
      <td>8</td>
    </tr>
  </tbody>
</table>
<p>4 rows × 71 columns</p>
</div></div></div>
</div>
<p>This dataset follows the standard format of handling timeseries data with pandas – one row per timestamp, one column per measurement type.  Because TMY files represent one year of data (no leap years), that means they’ll have 8760 rows.  The number of columns can vary depending on the source of the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of rows:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_tmy</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of columns:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df_tmy</span><span class="o">.</span><span class="n">columns</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of rows: 8760
Number of columns: 71
</pre></div>
</div>
</div>
</div>
<p>You can access single rows by pointing to its number location (iloc) or by using the index name it has. In this case, that is a dateTime</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tmy</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tmy</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;1990-01-01 01:00:00-05:00&#39;</span><span class="p">];</span>
</pre></div>
</div>
</div>
</div>
<p>You can also print all the column names in the dataframe</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_tmy</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;Date (MM/DD/YYYY)&#39;, &#39;Time (HH:MM)&#39;, &#39;ETR&#39;, &#39;ETRN&#39;, &#39;GHI&#39;, &#39;GHISource&#39;,
       &#39;GHIUncertainty&#39;, &#39;DNI&#39;, &#39;DNISource&#39;, &#39;DNIUncertainty&#39;, &#39;DHI&#39;,
       &#39;DHISource&#39;, &#39;DHIUncertainty&#39;, &#39;GHillum&#39;, &#39;GHillumSource&#39;,
       &#39;GHillumUncertainty&#39;, &#39;DNillum&#39;, &#39;DNillumSource&#39;, &#39;DNillumUncertainty&#39;,
       &#39;DHillum&#39;, &#39;DHillumSource&#39;, &#39;DHillumUncertainty&#39;, &#39;Zenithlum&#39;,
       &#39;ZenithlumSource&#39;, &#39;ZenithlumUncertainty&#39;, &#39;TotCld&#39;, &#39;TotCldSource&#39;,
       &#39;TotCldUncertainty&#39;, &#39;OpqCld&#39;, &#39;OpqCldSource&#39;, &#39;OpqCldUncertainty&#39;,
       &#39;DryBulb&#39;, &#39;DryBulbSource&#39;, &#39;DryBulbUncertainty&#39;, &#39;DewPoint&#39;,
       &#39;DewPointSource&#39;, &#39;DewPointUncertainty&#39;, &#39;RHum&#39;, &#39;RHumSource&#39;,
       &#39;RHumUncertainty&#39;, &#39;Pressure&#39;, &#39;PressureSource&#39;, &#39;PressureUncertainty&#39;,
       &#39;Wdir&#39;, &#39;WdirSource&#39;, &#39;WdirUncertainty&#39;, &#39;Wspd&#39;, &#39;WspdSource&#39;,
       &#39;WspdUncertainty&#39;, &#39;Hvis&#39;, &#39;HvisSource&#39;, &#39;HvisUncertainty&#39;, &#39;CeilHgt&#39;,
       &#39;CeilHgtSource&#39;, &#39;CeilHgtUncertainty&#39;, &#39;Pwat&#39;, &#39;PwatSource&#39;,
       &#39;PwatUncertainty&#39;, &#39;AOD&#39;, &#39;AODSource&#39;, &#39;AODUncertainty&#39;, &#39;Alb&#39;,
       &#39;AlbSource&#39;, &#39;AlbUncertainty&#39;, &#39;Lprecipdepth&#39;, &#39;Lprecipquantity&#39;,
       &#39;LprecipSource&#39;, &#39;LprecipUncertainty&#39;, &#39;PresWth&#39;, &#39;PresWthSource&#39;,
       &#39;PresWthUncertainty&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>There are 71 columns, which is quite a lot!  For now, let’s focus just on the ones that are most important for PV modeling – the irradiance, temperature, and wind speed columns, and extract them into a new DataFrame.</p>
</div>
<div class="section" id="irradiance">
<h2>Irradiance<a class="headerlink" href="#irradiance" title="Permalink to this headline">¶</a></h2>
<p>Irradiance is an instantaneous measurement of solar power over some area.  For practical purposes of measurement and interpretation, irradiance is expressed and separated into different components.</p>
<p><img alt="overview irradiance" src="_images/tutorial_1_DNIDHIGHI.PNG" /></p>
<p>The units of irradiance are watts per square meter.</p>
</div>
<div class="section" id="wind">
<h2>Wind<a class="headerlink" href="#wind" title="Permalink to this headline">¶</a></h2>
<p>Wind speed is measured with an anemometer.  The most common type is a the cup-type anemometer, shown on the right side of the picture below.  The number of rotations per time interval is used to calculate the wind speed.  The vane on the left is used to measure the direction of the wind.  Wind direction is reported as the direction from which the wind is blowing.</p>
<p><img src="https://pvpmc.sandia.gov/wp-content/uploads/2012/04/anemometer.jpg"></img></p>
</div>
<div class="section" id="air-temperature">
<h2>Air temperature<a class="headerlink" href="#air-temperature" title="Permalink to this headline">¶</a></h2>
<p>Also known as dry-bulb temperature, is the temperature of the ambient air when the measurement device is shielded from radiation and moisture. The most common method of air temperature measurement uses a resistive temperature device (RTD) or thermocouple within a radiation shield. The shield blocks sunlight from reaching the sensor (avoiding radiative heating), yet allows natural air flow around the sensor. More accurate temperature measurement devices utilize a shield which forces air across the sensor.</p>
<p>Air temperature is typically measured on the Celsius scale.</p>
<p>Air temperature plays a large role in PV system performance as PV modules and inverters are cooled convectively by the surrounding air.</p>
<p><img src="https://pvpmc.sandia.gov/wp-content/uploads/2012/04/AmbTemp.jpg" width="400" height="400"> </img></p>
</div>
<div class="section" id="downselect-columns">
<h2>Downselect columns<a class="headerlink" href="#downselect-columns" title="Permalink to this headline">¶</a></h2>
<p>There are a lot more weather data in that file that you can access. To investigate all the column headers, we used <code class="docutils literal notranslate"><span class="pre">.keys()</span></code> above. Always read the <a class="reference external" href="https://www.nrel.gov/docs/fy08osti/43156.pdf">Instruction Manual</a> for the weather files to get more details on how the data is aggregated, units, etc.</p>
<p>At this point we are interested in <b> GHI, DHI, DNI, DryBulb </b> and <b> Wind Speed </b>. For this NREL TMY3 dataset the units of irradiance are W/m², dry bulb temperature is in °C, and wind speed is m/s.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># GHI, DHI, DNI are irradiance measurements</span>
<span class="c1"># DryBulb is the &quot;dry-bulb&quot; (ambient) temperature</span>
<span class="c1"># Wspd is wind speed</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df_tmy</span><span class="p">[[</span><span class="s1">&#39;GHI&#39;</span><span class="p">,</span> <span class="s1">&#39;DHI&#39;</span><span class="p">,</span> <span class="s1">&#39;DNI&#39;</span><span class="p">,</span> <span class="s1">&#39;DryBulb&#39;</span><span class="p">,</span> <span class="s1">&#39;Wspd&#39;</span><span class="p">]]</span>
<span class="c1"># show the first 15 rows:</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>GHI</th>
      <th>DHI</th>
      <th>DNI</th>
      <th>DryBulb</th>
      <th>Wspd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1990-01-01 01:00:00-05:00</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>10.0</td>
      <td>6.2</td>
    </tr>
    <tr>
      <th>1990-01-01 02:00:00-05:00</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>10.0</td>
      <td>5.2</td>
    </tr>
    <tr>
      <th>1990-01-01 03:00:00-05:00</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>10.0</td>
      <td>5.7</td>
    </tr>
    <tr>
      <th>1990-01-01 04:00:00-05:00</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>10.0</td>
      <td>5.7</td>
    </tr>
    <tr>
      <th>1990-01-01 05:00:00-05:00</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>10.0</td>
      <td>5.2</td>
    </tr>
    <tr>
      <th>1990-01-01 06:00:00-05:00</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>10.0</td>
      <td>4.1</td>
    </tr>
    <tr>
      <th>1990-01-01 07:00:00-05:00</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>10.0</td>
      <td>4.1</td>
    </tr>
    <tr>
      <th>1990-01-01 08:00:00-05:00</th>
      <td>9</td>
      <td>9</td>
      <td>1</td>
      <td>10.0</td>
      <td>5.2</td>
    </tr>
    <tr>
      <th>1990-01-01 09:00:00-05:00</th>
      <td>46</td>
      <td>46</td>
      <td>3</td>
      <td>10.0</td>
      <td>5.2</td>
    </tr>
    <tr>
      <th>1990-01-01 10:00:00-05:00</th>
      <td>79</td>
      <td>78</td>
      <td>4</td>
      <td>10.6</td>
      <td>5.2</td>
    </tr>
    <tr>
      <th>1990-01-01 11:00:00-05:00</th>
      <td>199</td>
      <td>198</td>
      <td>3</td>
      <td>11.7</td>
      <td>6.2</td>
    </tr>
    <tr>
      <th>1990-01-01 12:00:00-05:00</th>
      <td>261</td>
      <td>260</td>
      <td>3</td>
      <td>11.7</td>
      <td>5.2</td>
    </tr>
    <tr>
      <th>1990-01-01 13:00:00-05:00</th>
      <td>155</td>
      <td>155</td>
      <td>0</td>
      <td>11.7</td>
      <td>5.2</td>
    </tr>
    <tr>
      <th>1990-01-01 14:00:00-05:00</th>
      <td>144</td>
      <td>144</td>
      <td>2</td>
      <td>11.7</td>
      <td>3.1</td>
    </tr>
    <tr>
      <th>1990-01-01 15:00:00-05:00</th>
      <td>131</td>
      <td>131</td>
      <td>1</td>
      <td>11.1</td>
      <td>4.1</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="plotting-time-series-data-with-pandas-and-matplotlib">
<h2>Plotting time series data with pandas and matplotlib<a class="headerlink" href="#plotting-time-series-data-with-pandas-and-matplotlib" title="Permalink to this headline">¶</a></h2>
<p>Let’s make some plots to get a better idea of what TMY data gives us.</p>
<div class="section" id="id1">
<h3>Irradiance<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>First, the three irradiance fields:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_week</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">24</span><span class="o">*</span><span class="mi">7</span><span class="p">)</span>  <span class="c1"># Plotting 7 days, each one has 24 hours or entries</span>
<span class="n">first_week</span><span class="p">[[</span><span class="s1">&#39;GHI&#39;</span><span class="p">,</span> <span class="s1">&#39;DHI&#39;</span><span class="p">,</span> <span class="s1">&#39;DNI&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Irradiance [W/m$^2$]&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Tutorial 1 - TMY Weather Data_29_0.png" src="_images/Tutorial 1 - TMY Weather Data_29_0.png" />
</div>
</div>
<p>Let’s control the parameters a bit more</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">birthday</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;1990-11-06&#39;</span><span class="p">:</span><span class="s1">&#39;1990-11-06&#39;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">birthday</span><span class="p">[</span><span class="s1">&#39;DNI&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">birthday</span><span class="p">[</span><span class="s1">&#39;DHI&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">birthday</span><span class="p">[</span><span class="s1">&#39;GHI&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span> 
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Irradiance [W/m$^2$]&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Tutorial 1 - TMY Weather Data_31_0.png" src="_images/Tutorial 1 - TMY Weather Data_31_0.png" />
</div>
</div>
<div class="section" id="exercise">
<h4>Exercise<a class="headerlink" href="#exercise" title="Permalink to this headline">¶</a></h4>
<p>How does the Irradiance look like in YOUR birthday?</p>
<p>Hint: the next cell is ‘Markdown’, you need to switch it to ‘Code’ for it to run</p>
<p>birthday = df.loc[] # Type your birthday here using the 1990 year, i.e. ‘1990-11-06’:’1990-11-06’
plt.plot(birthday[‘DNI’], color=’g’)
plt.plot(birthday[‘DHI’], color=’b’, marker=’.’)
plt.plot(birthday[‘GHI’], color=’r’, marker=’s’)
plt.ylabel(‘Irradiance [W/m<span class="math notranslate nohighlight">\(^2\)</span>]’);</p>
<p>GHI, DHI, and DNI are the three “basic” ways of measuring irradiance, although each of them is measured in units of power per area (watts per square meter):</p>
<ul class="simple">
<li><p>GHI: Global Horizontal Irradiance; the total sunlight intensity falling on a horizontal plane</p></li>
<li><p>DHI: Diffuse Horizontal Irradiance; the subset of sunlight falling on a horizontal plane that isn’t coming directly from the sun (e.g., the light that makes the sky blue)</p></li>
<li><p>DNI: Direct Normal Irradiance; the subset of sunlight coming directly from the sun</p></li>
</ul>
<p><img alt="Overview" src="_images/t1_GHI.PNG" /></p>
<p><img alt="Overview" src="_images/t1_DHI.PNG" /></p>
<p><img alt="Overview" src="_images/t1_DNI.PNG" /></p>
<p>Later tutorials will show how these three values are used in PV modeling.  For now, let’s just get a qualitative understanding of the differences between them: looking at the above plot, there is a pattern where when DNI is high, DHI is low.  The sun puts out a (roughly) constant amount of energy, which means photons either make it through the atmosphere without scattering and are counted as direct irradiance, or they tend to get scattered and become part of the diffuse irradiance, but not both.  Looking at DNI makes it easy to pick out which hours are cloud and which are sunny – most days in January are rather overcast with low irradiance, but the sun does occasionally break through.</p>
<p>In addition to daily variation, there is also seasonal variation in irradiance.  Let’s compare a winter week with a summer week, using pandas to select out a summertime subset.  Notice the increased intensity in summer – GHI peaks around 900 W/m^2, whereas in winter the maximum was more like 500 W/m^2.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summer_week</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;1990-06-01&#39;</span><span class="p">:</span><span class="s1">&#39;1990-06-08&#39;</span><span class="p">]</span>
<span class="n">summer_week</span><span class="p">[[</span><span class="s1">&#39;GHI&#39;</span><span class="p">,</span> <span class="s1">&#39;DHI&#39;</span><span class="p">,</span> <span class="s1">&#39;DNI&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Irradiance [W/m$^2$]&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Tutorial 1 - TMY Weather Data_38_0.png" src="_images/Tutorial 1 - TMY Weather Data_38_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="temperature">
<h3>Temperature<a class="headerlink" href="#temperature" title="Permalink to this headline">¶</a></h3>
<p>Next up is temperature:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_week</span><span class="p">[</span><span class="s1">&#39;DryBulb&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Ambient Temperature [°C]&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Tutorial 1 - TMY Weather Data_40_0.png" src="_images/Tutorial 1 - TMY Weather Data_40_0.png" />
</div>
</div>
</div>
<div class="section" id="wind-speed">
<h3>Wind speed<a class="headerlink" href="#wind-speed" title="Permalink to this headline">¶</a></h3>
<p>And finally, wind speed:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">first_week</span><span class="p">[</span><span class="s1">&#39;Wspd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Wind Speed [m/s]&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Tutorial 1 - TMY Weather Data_42_0.png" src="_images/Tutorial 1 - TMY Weather Data_42_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="aggregating-hourly-data-to-monthly-summaries">
<h2>Aggregating hourly data to monthly summaries<a class="headerlink" href="#aggregating-hourly-data-to-monthly-summaries" title="Permalink to this headline">¶</a></h2>
<p>Pandas makes it easy to roll-up timeseries data into summary values. We can use the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.resample.html"><code class="docutils literal notranslate"><span class="pre">DataFrame.resample()</span></code></a> function with <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/user_guide/timeseries.html#dateoffset-objects"><code class="docutils literal notranslate"><span class="pre">DateOffsets</span></code></a> like <code class="docutils literal notranslate"><span class="pre">'M'</span></code> for months.  For example, we can calculate total monthly GHI as a quick way to visualize the seasonality of solar resource:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># summing hourly irradiance (W/m^2) gives insolation (W h/m^2)</span>
<span class="n">monthly_ghi</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;GHI&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">monthly_ghi</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1990-01-31 00:00:00-05:00     74848
1990-02-28 00:00:00-05:00     85751
1990-03-31 00:00:00-05:00    131766
1990-04-30 00:00:00-05:00    162302
Freq: M, Name: GHI, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">monthly_ghi</span> <span class="o">=</span> <span class="n">monthly_ghi</span><span class="o">.</span><span class="n">tz_localize</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>  <span class="c1"># don&#39;t need timezone for monthly data</span>
<span class="n">monthly_ghi</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Monthly Global Horizontal Irradiance</span><span class="se">\n</span><span class="s1">[W h/m$^2$]&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Tutorial 1 - TMY Weather Data_45_0.png" src="_images/Tutorial 1 - TMY Weather Data_45_0.png" />
</div>
</div>
<p>We can also take monthly averages instead of monthly sums:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">ax1</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>  <span class="c1"># add a second y-axis</span>
<span class="n">monthly_average_temp_wind</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;DryBulb&#39;</span><span class="p">,</span> <span class="s1">&#39;Wspd&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">monthly_average_temp_wind</span><span class="p">[</span><span class="s1">&#39;DryBulb&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">)</span>
<span class="n">monthly_average_temp_wind</span><span class="p">[</span><span class="s1">&#39;Wspd&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Ambient Temperature [$\degree$ C]&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Wind Speed [m/s]&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower left&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;lower right&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Tutorial 1 - TMY Weather Data_47_0.png" src="_images/Tutorial 1 - TMY Weather Data_47_0.png" />
</div>
</div>
<div class="section" id="id2">
<h3>Exercise<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Plot the Average DNI per Day</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="n">daily_average_DNI</span> <span class="o">=</span> <span class="n">df</span><span class="p">[[</span><span class="s1">&#39;&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># Add the column name, and resample by day. Month is &#39;M&#39;, day is..</span>
    <span class="n">daily_average_DNI</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="k">except</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;You haven&#39;t finished this exercise correctly, try again!&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>You haven&#39;t finished this exercise correctly, try again!
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="where-to-get-free-solar-irradiance-data">
<h2>Where to get <em>Free</em> Solar Irradiance Data?<a class="headerlink" href="#where-to-get-free-solar-irradiance-data" title="Permalink to this headline">¶</a></h2>
<p>There are many different sources of solar irradiance data. For your projects, these are some of the most common:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://nsrdb.nrel.gov/data-sets/archives.html">TMY3/TMY2</a> - like the data we loaded earlier on this example. This database of TMY3 <code class="docutils literal notranslate"><span class="pre">.csv</span></code> files and TMY2 files have been archived by NREL.</p></li>
<li><p><a class="reference external" href="https://maps.nrel.gov/nsrdb-viewer/">NSRDB</a> - National Solar Radiation Database. You can access data through the website for many locations accross the world, or you can use their <a class="reference external" href="https://developer.nrel.gov/docs/solar/nsrdb/">web API</a> to download data programmatically. An “API” is an <a class="reference external" href="https://en.wikipedia.org/wiki/API">“application programming interface”</a>, and a “web API” is a programming interface that allows you to write code to interact with web services like the NSRDB.</p></li>
<li><p><a class="reference external" href="https://www.energy.gov/eere/buildings/downloads/energyplus-0">EPW</a> - Energy Plus Weather data is available for many locations accross the world. It’s in its own format file (‘EPW’) so you can’t open it easily in a spreadsheet program like Excel, but you can use <a class="reference external" href="https://pvlib-python.readthedocs.io/en/stable/generated/pvlib.iotools.read_epw.html"><code class="docutils literal notranslate"><span class="pre">pvlib.iotools.read_epw()</span></code></a> to get it into a dataframe and use it.</p></li>
<li><p><a class="reference external" href="https://ec.europa.eu/jrc/en/pvgis">PVGIS</a> - Free global weather data provided by the European Union and derived from many govermental agencies including the NSRDB. PVGIS also provides a web API. You can get PVGIS TMY data using <a class="reference external" href="https://pvlib-python.readthedocs.io/en/stable/generated/pvlib.iotools.get_pvgis_tmy.html"><code class="docutils literal notranslate"><span class="pre">pvlib.iotools.get_pvgis_tmy()</span></code></a>.</p></li>
<li><p>Perhaps another useful link: <a class="reference external" href="https://sam.nrel.gov/weather-data.html">https://sam.nrel.gov/weather-data.html</a></p></li>
</ul>
</div>
<div class="section" id="where-else-can-you-get-historical-irradiance-data">
<h2>Where else can you get historical irradiance data?<a class="headerlink" href="#where-else-can-you-get-historical-irradiance-data" title="Permalink to this headline">¶</a></h2>
<p>There are several commercial providers of solar irradiance data. Data is available at different spatial and time resolutions. Each provider offers data under subscription that will provide access to irradiance (and other weather variables) via API to leverage in python.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.solaranywhere.com/">SolarAnywhere</a></p></li>
<li><p><a class="reference external" href="https://solargis.com/">SolarGIS</a></p></li>
<li><p><a class="reference external" href="https://www.vaisala.com/en">Vaisala</a></p></li>
<li><p><a class="reference external" href="https://meteonorm.com/en/">Meteonorm</a></p></li>
<li><p><a class="reference external" href="https://src.dnvgl.com/">DNV Solar Resource Compass</a></p></li>
</ul>
<p><img alt="NSRDB Example" src="_images/tutorial_1_NSRDB_example.PNG" /></p>
</div>
<div class="section" id="nrel-api-key">
<h2>NREL API Key<a class="headerlink" href="#nrel-api-key" title="Permalink to this headline">¶</a></h2>
<p>At the <a class="reference external" href="https://developer.nrel.gov/">NREL Developer Network</a>, there are <a class="reference external" href="https://en.wikipedia.org/wiki/API">APIs</a> to a lot of valuable <a class="reference external" href="https://developer.nrel.gov/docs/solar/">solar resources</a> like <a class="reference external" href="https://developer.nrel.gov/docs/solar/nsrdb/">weather data from the NSRDB</a>, <a class="reference external" href="https://developer.nrel.gov/docs/solar/pvdaq-v3/">operational data from PVDAQ</a>, or indicative calculations using <a class="reference external" href="https://developer.nrel.gov/docs/solar/pvwatts/">PVWatts</a>. In order to use these resources from NREL, you need to <a class="reference external" href="https://developer.nrel.gov/signup/">register for a free API key</a>. You can test out the APIs using the <code class="docutils literal notranslate"><span class="pre">DEMO_KEY</span></code> but it has limited bandwidth compared to the <a class="reference external" href="https://developer.nrel.gov/docs/rate-limits/">usage limit for registered users</a>. NREL has some <a class="reference external" href="https://developer.nrel.gov/docs/api-key/">API usage instructions</a>, but pvlib has a few builtin functions, like <a class="reference external" href="https://pvlib-python.readthedocs.io/en/stable/generated/pvlib.iotools.get_psm3.html"><code class="docutils literal notranslate"><span class="pre">pvlib.iotools.get_psm3()</span></code></a>, that wrap the NREL API, and call them for you to make it much easier to use. Skip ahead to the next section to learn more. But before you do…</p>
<p><strong>Please pause now to visit <a class="reference external" href="https://developer.nrel.gov/signup/">https://developer.nrel.gov/signup/</a> and get an API key.</strong></p>
<div class="section" id="application-programming-interface-api">
<h3>Application Programming Interface (API)<a class="headerlink" href="#application-programming-interface-api" title="Permalink to this headline">¶</a></h3>
<p>What exactly is an API? Nowadays, the phrase is used interchangeably with a “web API” but in general an API is just a recipe for how to interface with a application programmatically, <em>IE</em>: in code. An API could be as simple as a function signature or its published documentation, <em>EG</em>: the API for the <code class="docutils literal notranslate"><span class="pre">solarposition</span></code> function is you give it an ISO8601 formatted date with a timezone, the latitude, longitude, and elevation as numbers, and it returns the zenith and azimuth as numbers.</p>
<p>A web API is the same, except the application is a web service, that you access at its URL using web methods. We won’t go into too much more detail here, but the most common web method is <code class="docutils literal notranslate"><span class="pre">GET</span></code> which is pretty self explanatory. Look over the <a class="reference external" href="https://developer.nrel.gov/docs/api-key/">NREL web usage instructions</a> for some examples, but interacting with a web API can be as easy as entering a URL into a browser. Try the URL below to <em>get</em> the PVWatts energy output for a fixed tilt site in <a class="reference external" href="https://goo.gl/maps/awkEcNGzSur9Has18">Broomfield, CO</a>.</p>
<p><a class="reference external" href="https://developer.nrel.gov/api/pvwatts/v6.json?api_key=DEMO_KEY&amp;lat=40&amp;lon=-105&amp;system_capacity=4&amp;azimuth=180&amp;tilt=40&amp;array_type=1&amp;module_type=1&amp;losses=10">https://developer.nrel.gov/api/pvwatts/v6.json?api_key=DEMO_KEY&amp;lat=40&amp;lon=-105&amp;system_capacity=4&amp;azimuth=180&amp;tilt=40&amp;array_type=1&amp;module_type=1&amp;losses=10</a></p>
<p>In addition to just using your browser, you can also access web APIs programmatically. The most popular Python package to interact with web APIs is <a class="reference external" href="https://docs.python-requests.org/en/master/">requests</a>. There’s also free open source command-line tools like <a class="reference external" href="https://curl.se/">cURL</a> and <a class="reference external" href="https://httpie.io/">HTTPie</a>, and a popular nagware/freemium GUI application called <a class="reference external" href="https://www.postman.com/">Postman</a>.</p>
<p><strong>If you have an NREL API key please enter it in the next cell.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">NREL_API_KEY</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># &lt;-- please set your NREL API key here</span>

<span class="c1"># note you must use &quot;quotes&quot; around your key, for example:</span>
<span class="c1"># NREL_API_KEY = &#39;DEMO_KEY&#39;  # single or double both work fine</span>

<span class="c1"># during the live tutorial, we&#39;ve stored a dedicated key on our server</span>
<span class="k">if</span> <span class="n">NREL_API_KEY</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">NREL_API_KEY</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;NREL_API_KEY&#39;</span><span class="p">]</span>  <span class="c1"># get dedicated key for tutorial from servier</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">NREL_API_KEY</span> <span class="o">=</span> <span class="s1">&#39;DEMO_KEY&#39;</span>  <span class="c1"># OK for this demo, but better to get your own key</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="fetching-tmys-from-the-nsrdb">
<h2>Fetching TMYs from the NSRDB<a class="headerlink" href="#fetching-tmys-from-the-nsrdb" title="Permalink to this headline">¶</a></h2>
<p>The example TMY dataset used here is from an airport in North Carolina, but what if we wanted to model a PV system somewhere else? The NSRDB, one of many sources of weather data intended for PV modeling, is free and easy to access using pvlib. As an example, we’ll fetch a TMY dataset for Albuquerque, New Mexico at coordinates <a class="reference external" href="https://www.google.com/maps/&#64;35.0844,-106.6504,9z">(35.0844, -106.6504)</a>. We use <a class="reference external" href="https://pvlib-python.readthedocs.io/en/stable/generated/pvlib.iotools.get_psm3.html"><code class="docutils literal notranslate"><span class="pre">pvlib.iotools.get_psm3()</span></code></a> which returns a Python dictionary of metadata and a Pandas dataframe of the timeseries weather data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">metadata</span><span class="p">,</span> <span class="n">df_abq</span> <span class="o">=</span> <span class="n">pvlib</span><span class="o">.</span><span class="n">iotools</span><span class="o">.</span><span class="n">get_psm3</span><span class="p">(</span>
    <span class="n">latitude</span><span class="o">=</span><span class="mf">35.0844</span><span class="p">,</span> <span class="n">longitude</span><span class="o">=-</span><span class="mf">106.6504</span><span class="p">,</span>
    <span class="n">api_key</span><span class="o">=</span><span class="n">NREL_API_KEY</span><span class="p">,</span>
    <span class="n">email</span><span class="o">=</span><span class="s1">&#39;mark.mikofski@dnv.com&#39;</span><span class="p">,</span>  <span class="c1"># &lt;-- any email works here fine</span>
    <span class="n">names</span><span class="o">=</span><span class="s1">&#39;tmy&#39;</span><span class="p">)</span>
<span class="n">metadata</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;Source&#39;: &#39;NSRDB&#39;,
 &#39;Location ID&#39;: &#39;94139&#39;,
 &#39;City&#39;: &#39;-&#39;,
 &#39;State&#39;: &#39;-&#39;,
 &#39;Country&#39;: &#39;-&#39;,
 &#39;Latitude&#39;: 35.09,
 &#39;Longitude&#39;: -106.66,
 &#39;Time Zone&#39;: -7,
 &#39;Elevation&#39;: 1496,
 &#39;Local Time Zone&#39;: -7,
 &#39;Dew Point Units&#39;: &#39;c&#39;,
 &#39;DHI Units&#39;: &#39;w/m2&#39;,
 &#39;DNI Units&#39;: &#39;w/m2&#39;,
 &#39;GHI Units&#39;: &#39;w/m2&#39;,
 &#39;Temperature Units&#39;: &#39;c&#39;,
 &#39;Pressure Units&#39;: &#39;mbar&#39;,
 &#39;Wind Direction Units&#39;: &#39;Degrees&#39;,
 &#39;Wind Speed&#39;: &#39;m/s&#39;,
 &#39;Surface Albedo Units&#39;: &#39;N/A&#39;,
 &#39;Version&#39;: &#39;3.2.0&#39;}
</pre></div>
</div>
</div>
</div>
<p>TMY datasets from the PSM3 service of the NSRDB are timestamped using the real year that the measurements came from. The <a class="reference external" href="https://pvlib-python.readthedocs.io/en/stable/generated/pvlib.iotools.read_tmy3.html"><code class="docutils literal notranslate"><span class="pre">pvlib.iotools.read_tmy3()</span></code></a> function had a <code class="docutils literal notranslate"><span class="pre">coerce_year</span></code> argument to force everything to align to a single dummy year, but <code class="docutils literal notranslate"><span class="pre">pvlib.iotools.get_psm3()</span></code> doesn’t have that feature. For convenience let’s standardize the data to 1990 and then compare monthly GHI to the North Carolina location:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_abq</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1990</span>
<span class="n">df_abq</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">df_abq</span><span class="p">[[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="s1">&#39;Month&#39;</span><span class="p">,</span> <span class="s1">&#39;Day&#39;</span><span class="p">,</span> <span class="s1">&#39;Hour&#39;</span><span class="p">]])</span>

<span class="n">ghi_comparison</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;NC&#39;</span><span class="p">:</span> <span class="n">monthly_ghi</span><span class="p">,</span>  <span class="c1"># using the monthly values from earlier</span>
    <span class="s1">&#39;NM&#39;</span><span class="p">:</span> <span class="n">df_abq</span><span class="p">[</span><span class="s1">&#39;GHI&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;M&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">(),</span>
<span class="p">})</span>

<span class="n">ghi_comparison</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Monthly GHI [W h/m^2]&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Tutorial 1 - TMY Weather Data_57_0.png" src="_images/Tutorial 1 - TMY Weather Data_57_0.png" />
</div>
</div>
<p>It’s not too surprising to see that our New Mexico location is significantly sunnier than the one in North Carolina.</p>
<p><a class="reference external" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" src="https://i.creativecommons.org/l/by/4.0/88x31.png" /></a></p>
<p>This work is licensed under a <a class="reference external" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.</p>
</div>
<div class="toctree-wrapper compound">
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "PVSC-Python-Tutorials/pyData-2021-Solar-PV-Modeling",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
     <div id="next">
        <a class="right-next" href="Tutorial%202%20-%20POA%20Irradiance.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Tutorial 2 - POA Irradiance</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Silvana Ayala Pelaez, Mark Mikofski, Kevin Anderson<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>